{"version":3,"file":"PreviewMovieItem.5d2ff53a.js","sources":["../../src/components/PreviewMovieItem.vue"],"sourcesContent":["<script>\r\nimport {\r\n  ref,\r\n  defineComponent,\r\n  onUnmounted,\r\n  onMounted,\r\n  onBeforeUnmount,\r\n  computed,\r\n} from \"vue\";\r\nimport PlayIcon from \"@/components/Icon/Play.vue\";\r\nimport CheckMark from \"@/components/Icon/CheckMark.vue\";\r\nimport Plus from \"@/components/Icon/Plus.vue\";\r\nimport ThumbUp from \"@/components/Icon/ThumbUp.vue\";\r\nimport ArrowDown from \"@/components/Icon/ArrowDown.vue\";\r\nimport { apiGetPopularMovie } from \"@/apis/movie.js\";\r\nimport { useMovieModal } from \"@/composables/movieModal.js\";\r\nimport { useUserStore } from \"@/stores/user.js\";\r\nimport {\r\n  addToMyMovieHandle,\r\n  removeToMyMovieHandle,\r\n} from \"@/common/movieHandle.js\";\r\n\r\nconst { showMovieModal, resetMovieModalData } = useMovieModal();\r\n\r\nexport default defineComponent({\r\n  name: \"previewSlideMovie\",\r\n  props: {\r\n    movie: {\r\n      type: Object,\r\n      required: true,\r\n    },\r\n    left: {\r\n      type: Number,\r\n      required: true,\r\n    },\r\n    top: {\r\n      type: Number,\r\n      required: true,\r\n    },\r\n    imgurl: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    imgbox: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    width: {\r\n      type: Number,\r\n      required: true,\r\n    },\r\n    height: {\r\n      type: Number,\r\n      required: true,\r\n    },\r\n    isFirstItem: {\r\n      type: Boolean,\r\n      required: true,\r\n    },\r\n    isLastItem: {\r\n      type: Boolean,\r\n      required: true,\r\n    },\r\n    // msg: {\r\n    //   type: String,\r\n    //   required: true,\r\n    // },\r\n  },\r\n  setup(props) {\r\n    const movieID = props.movie.movie.id;\r\n    const isNetflix = props.movie.isNetflix;\r\n    console.log(\"props.movie.movie\", props.movie.movie);\r\n    const store = useUserStore();\r\n    let userMovies = store.getUserMovies();\r\n    const isAddedMovie = ref(false);\r\n    isAddedMovie.value = userMovies.find((id) =>\r\n      id.toString().includes(movieID)\r\n    )\r\n      ? true\r\n      : false;\r\n\r\n    const count = ref(0);\r\n    const isActive = ref(false);\r\n    onMounted(() => {\r\n      let previewModal = document.querySelector(\"#previewModal\");\r\n      previewModal.style.top = props.top + \"px\";\r\n      previewModal.style.left = props.left + \"px\";\r\n\r\n      setTimeout(() => {\r\n        isActive.value = true;\r\n      }, 20);\r\n    });\r\n    onBeforeUnmount(() => {\r\n      isActive.value = false;\r\n    });\r\n\r\n    function getMovieScore(score) {\r\n      return (score * 10).toFixed(0);\r\n    }\r\n\r\n    const similarMovies = ref([]);\r\n    function showModal() {\r\n      let movieData = props.movie.movie;\r\n      let genres = movieData.genre_ids ? movieData.genre_ids : movieData.genres;\r\n      getSimilarMovies(genres);\r\n    }\r\n\r\n    const getSimilarMovies = (genres) => {\r\n      if (genres && genres.length) {\r\n        let tag = genres[0]._id;\r\n\r\n        apiGetPopularMovie(1, tag).then((values) => {\r\n          let data = values.data.results;\r\n          similarMovies.value = data.filter((m) => m.id !== props.movie.id);\r\n\r\n          let movieData = props.movie.movie;\r\n          let reuslt = {\r\n            name: props.movie.title,\r\n            backdrop_path: props.imgurl,\r\n            vote_average: props.movie.score,\r\n            overview: movieData.overview,\r\n            similarMovies: similarMovies.value,\r\n            isNetflix,\r\n            id: movieID,\r\n          };\r\n\r\n          resetMovieModalData(reuslt);\r\n          showMovieModal();\r\n        });\r\n      }\r\n    };\r\n\r\n    const addToMyMovies = async () => {\r\n      let id = isNetflix ? \"n\" + movieID : movieID; // 針對 neflix 需額外 api 搜索處理 避免myMovies api 查不到\r\n      let isAdded = await addToMyMovieHandle(id);\r\n      isAddedMovie.value = isAdded ? true : false;\r\n    };\r\n\r\n    const removeToMyMovies = async () => {\r\n      let isRemove = await removeToMyMovieHandle(movieID);\r\n      isAddedMovie.value = isRemove ? false : true;\r\n    };\r\n\r\n    return {\r\n      count,\r\n      isActive,\r\n      getMovieScore,\r\n      showModal,\r\n      isAddedMovie,\r\n      addToMyMovies,\r\n      removeToMyMovies,\r\n    };\r\n  },\r\n  components: {\r\n    PlayIcon,\r\n    CheckMark,\r\n    Plus,\r\n    ArrowDown,\r\n    ThumbUp,\r\n  },\r\n});\r\n</script>\r\n<template>\r\n  <div\r\n    class=\"previewMovie-wrapper\"\r\n    :class=\"{ active: isActive, isFirstItem, isLastItem }\"\r\n  >\r\n    <div\r\n      class=\"movie-box\"\r\n      :style=\"{ width: width + 'px', height: height + 'px' }\"\r\n    >\r\n      <a\r\n        class=\"movie-bg\"\r\n        :style=\"{\r\n          'background-image':\r\n            'url(https://image.tmdb.org/t/p/w300' + imgurl + ')',\r\n        }\"\r\n      >\r\n      </a>\r\n    </div>\r\n    <div class=\"info\">\r\n      <div class=\"infoBtns-wrapper\">\r\n        <div class=\"left\">\r\n          <div class=\"infoIcon-btn play\">\r\n            <PlayIcon />\r\n          </div>\r\n\r\n          <!-- 從我的片單移除 -->\r\n          <div\r\n            v-show=\"isAddedMovie\"\r\n            @click=\"removeToMyMovies\"\r\n            class=\"infoIcon-btn\"\r\n          >\r\n            <CheckMark />\r\n          </div>\r\n          <!-- 新增至我的片單 -->\r\n          <div\r\n            class=\"infoIcon-btn\"\r\n            @click=\"addToMyMovies\"\r\n            v-show=\"!isAddedMovie\"\r\n          >\r\n            <Plus />\r\n          </div>\r\n          <div class=\"infoIcon-btn\">\r\n            <ThumbUp />\r\n          </div>\r\n        </div>\r\n        <div class=\"right\">\r\n          <div class=\"infoIcon-btn\" @click=\"showModal\">\r\n            <!-- <font-awesome-icon icon=\"chevron-down\" /> -->\r\n            <ArrowDown />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"preview-info\">\r\n        <h3 class=\"movie-title\">{{ movie.title }}</h3>\r\n        <div class=\"score match-score\" v-if=\"movie.score\">\r\n          {{ getMovieScore(movie.score) }}% 適合你\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<style lang=\"scss\" scoped>\r\n.previewMovie-wrapper {\r\n  position: relative;\r\n  transition: ease 0.3s;\r\n  transform: scale(1);\r\n  &.isFirstItem {\r\n    transform-origin: left;\r\n  }\r\n  &.isLastItem {\r\n    transform-origin: right;\r\n  }\r\n  &.active {\r\n    transform: scale(1.4);\r\n    .info {\r\n      opacity: 1;\r\n    }\r\n  }\r\n  .movie-box {\r\n    display: block;\r\n    position: relative;\r\n    width: 100%;\r\n    height: 100%;\r\n    overflow: hidden;\r\n    border-top-left-radius: 5px;\r\n    border-top-right-radius: 5px;\r\n    box-shadow: rgb(0 0 0 / 75%) 0px 3px 10px;\r\n\r\n    .movie-bg {\r\n      display: block;\r\n      background-position: center center;\r\n      background-repeat: no-repeat;\r\n      background-size: cover;\r\n      position: absolute;\r\n      left: 0px;\r\n      top: 0px;\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n}\r\n.info {\r\n  position: absolute;\r\n  margin-top: -1px;\r\n  z-index: 10;\r\n  transition: ease 0.3s;\r\n  width: 100%;\r\n  background: var(--color-background);\r\n  color: var(--color-text);\r\n  opacity: 0;\r\n  padding: 1rem;\r\n  overflow: hidden;\r\n  border-bottom-left-radius: 5px;\r\n  border-bottom-right-radius: 5px;\r\n  box-shadow: rgb(0 0 0 / 75%) 0px 6px 10px;\r\n\r\n  .infoBtns-wrapper {\r\n    margin-bottom: 8px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    .left {\r\n      display: flex;\r\n      .infoIcon-btn:not(:last-child) {\r\n        margin-right: 5px;\r\n      }\r\n    }\r\n\r\n    .infoIcon-btn {\r\n      width: 30px;\r\n      height: 30px;\r\n      border-radius: 50%;\r\n      border: 2px solid;\r\n      background-color: rgba(42, 42, 42, 0.6);\r\n      border-color: rgba(255, 255, 255, 0.5);\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      cursor: pointer;\r\n\r\n      &.play {\r\n        background-color: #fff;\r\n        color: #000;\r\n      }\r\n\r\n      svg {\r\n        width: 18px;\r\n        height: 18px;\r\n      }\r\n    }\r\n    @media screen and (max-width: 1440px) {\r\n      .infoIcon-btn {\r\n        width: 24px;\r\n        height: 24px;\r\n        svg {\r\n          width: 16px;\r\n          height: 16px;\r\n        }\r\n      }\r\n    }\r\n    @media screen and (max-width: 480px) {\r\n      .infoIcon-btn {\r\n        width: 20px;\r\n        height: 20px;\r\n        svg {\r\n          width: 12px;\r\n          height: 12px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .movie-title {\r\n    font-size: 16px;\r\n    margin-bottom: 0 !important;\r\n    font-weight: bold;\r\n  }\r\n  .match-score {\r\n    color: #46d369;\r\n    font-weight: bold;\r\n    font-size: 12px;\r\n  }\r\n}\r\n@media screen and (max-width: 480px) {\r\n  .info {\r\n    padding: 8px;\r\n    .movie-title {\r\n      font-size: 12px;\r\n    }\r\n  }\r\n}\r\n\r\n.light .infoIcon-btn {\r\n  background-color: #fff !important;\r\n  border-color: var(--border-color) !important;\r\n  color: var(---color-tex) !important;\r\n}\r\n</style>\r\n"],"names":["_createElementBlock","_createElementVNode","_normalizeStyle","_createVNode","_toDisplayString"],"mappings":"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"}