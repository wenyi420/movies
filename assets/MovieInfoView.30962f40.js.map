{"version":3,"file":"MovieInfoView.30962f40.js","sources":["../../src/views/MovieInfoView.vue"],"sourcesContent":["<script setup>\nimport { useRouter, useRoute } from \"vue-router\";\nimport {\n  apiGetMovieDetail,\n  apiGetYoutubeTrailer,\n  apiGetPopularMovie,\n  apiGetNexflixDetail,\n  apiGetNetflixTrailer,\n} from \"@/apis/movie.js\";\nimport { ref, reactive, computed } from \"vue\";\nimport { i18n } from \"@/i18n/config.js\";\n\nconst router = useRouter();\nconst route = useRoute();\nconst id = route.params.id;\nconst isNetflix = route.path.includes(\"netflix\") ? true : false;\nconst movieData = ref({});\nconst trailerData = ref({});\nconst similarMovies = ref([]);\n\nif (id) {\n  if (isNetflix) {\n    apiGetNexflixDetail(id).then((res) => {\n      console.log(\"res\", res);\n      movieData.value = res.data;\n      getSimilarMovies(res.data.genres);\n    });\n\n    apiGetNetflixTrailer(id).then((res) => {\n      console.log(\"trailer\", res.data);\n      trailerData.value = res.data;\n    });\n  } else {\n    apiGetMovieDetail(id).then((res) => {\n      console.log(\"res\", res);\n      movieData.value = res.data;\n      getSimilarMovies(res.data.genres);\n    });\n\n    apiGetYoutubeTrailer(id).then((res) => {\n      console.log(\"trailer\", res.data);\n      trailerData.value = res.data;\n    });\n  }\n} else {\n  alert(\"error\");\n}\n\nconst trailer = computed(() => {\n  let video = trailerData.value.results?.length\n    ? trailerData.value.results[0]\n    : null;\n  let hasYoutube = false;\n  if (video) {\n    if (video.site.toLowerCase() === \"youtube\" && video.key) {\n      hasYoutube = true;\n    }\n  }\n\n  return hasYoutube ? video.key : null;\n});\n\nconst getFirstSentence = (info) => {\n  if (info) {\n    let searchText;\n    if (i18n.global.locale === \"zh-TW\") {\n      searchText = \"。\";\n    }\n    if (i18n.global.locale === \"en\") {\n      searchText = \".\";\n    }\n    return info.split(searchText)[0] + searchText;\n  }\n  return \"\";\n};\n\n// date: 2021-01-01\nconst getReleaseYear = function (date) {\n  if (date) return date.split(\"-\")[0];\n};\n\nconst getRunTime = (time) => {\n  if (time) {\n    let result = \"\";\n    const MINUTE = 60;\n    const HH = Math.floor(time / MINUTE);\n    const MM = Math.floor(time % MINUTE);\n    if (HH) result += `${HH} 小時 `;\n    if (MM) result += `${MM} 分鐘`;\n    return result;\n  }\n};\n\n// [{id:28, name:動作}]\nconst getGenresName = (genres) => {\n  if (genres && Array.isArray(genres) && genres.length) {\n    return genres[0].name;\n  }\n};\n\nconst getSeason = (season) => {\n  return `第 ${season} 季`;\n};\n\nconst getSimilarMovies = (genres) => {\n  if (genres && genres.length) {\n    let tags;\n    if (isNetflix) {\n      tags = genres[0]._id; // 只取第一個避免 netflix genres 容易搜不到\n    } else {\n      tags = genres.map((g) => g.id).join(); // 18,16\n    }\n\n    apiGetPopularMovie(1, tags).then((values) => {\n      let data = values.data.results;\n      similarMovies.value = data.filter((m) => m.id !== movieData.value.id);\n    });\n  }\n};\n\nfunction goToMovie(id) {\n  router.push({ path: `/movie/${id}` });\n}\n\n/**\n * adult:false\nbackdrop_path:\"/egoyMDLqCxzjnSrWOz50uLlJWmD.jpg\"\nbelongs_to_collection:Object\nbudget:110000000\ngenres:Array[4]\nhomepage:\"https://www.sonicthehedgehogmovie.com\"\nid:675353\nimdb_id:\"tt12412888\"\noriginal_language:\"en\"\noriginal_title:\"Sonic the Hedgehog 2\"\noverview:\"全世界最受歡迎的藍色刺蝟又回來了，他在《音速小子2》一片中將有一場升級的精采冒險。音速小子索尼克在綠丘鎮安頓下來之後，他就急著要證明自己有能力成為一名真正的英雄。當蛋頭博士帶著全新的搭檔納克魯斯，又回來尋找一塊力量強大足以毀滅人類文明的翡翠的時候，他就面對了另一個嚴峻的考驗。  這次索尼克和他自己的跟班塔爾斯攜手合作，一起踏上一場環遊世界的冒險旅程，希望能在那塊翡翠落入壞人手中之前先找到它。《音速小子2》一片由《玩命關頭》及《死侍》系列電影幕後工作團隊精心打造，堅強的演員陣容包括再度回歸演出的詹姆斯馬斯登、為索尼克配音的班許瓦茲、蒂卡桑普特、娜塔莎羅斯威爾、亞當帕利以及金凱瑞，新加入的演員則是薛馬摩爾，以及為納克魯斯配音的伊卓瑞斯艾巴和為塔爾斯配音的柯琳歐尚納希。\"\npopularity:8640.583\nposter_path:\"/xVygjpclB5qhKa4HgCq4R8hH0b7.jpg\"\nproduction_companies:Array[5]\nproduction_countries:Array[2]\nrelease_date:\"2022-03-30\"\nrevenue:65000000\nruntime:122\nspoken_languages:Array[2]\nstatus:\"Released\"\ntagline:\"\"\ntitle:\"音速小子2\"\nvideo:false\nvote_average:7.8\nvote_count:257\n * \n * \n */\n</script>\n<template>\n  <div class=\"movieSection\">\n    <div class=\"info\">\n      <h1>{{ isNetflix ? movieData.name : movieData.title }}</h1>\n      <div class=\"info-metadata\">\n        <span class=\"info-metadata-year\">{{\n          getReleaseYear(\n            isNetflix ? movieData.first_air_date : movieData.release_date\n          )\n        }}</span>\n        <span class=\"info-spacer\"> | </span>\n        <span class=\"info-time info-spacer\" v-if=\"isNetflix\">{{\n          getSeason(movieData.number_of_seasons)\n        }}</span>\n        <span class=\"info-time info-spacer\" v-else>{{\n          getRunTime(movieData.runtime)\n        }}</span>\n        <span class=\"info-spacer\"> | </span>\n        <span class=\"info-time info-spacer\">{{\n          getGenresName(movieData.genres)\n        }}</span>\n      </div>\n      <div class=\"info-desc\">\n        {{ getFirstSentence(movieData.overview) }}\n      </div>\n    </div>\n    <div class=\"img-box\">\n      <div\n        class=\"img-bg\"\n        :style=\"{\n          'background-image':\n            'url(' +\n            'https://www.themoviedb.org/t/p/w1920_and_h800_multi_faces/' +\n            movieData.backdrop_path +\n            ')',\n        }\"\n      ></div>\n    </div>\n  </div>\n\n  <div class=\"nmtitle-section\" v-if=\"trailer\">\n    <div class=\"section-header\">\n      <h2 class=\"section-header-text\">影片</h2>\n      <h2 class=\"section-subheader-text\">{{ movieData.title }}</h2>\n    </div>\n    <div v-if=\"trailer\" style=\"margin: 16px 0\">\n      <!-- 預告片資訊：{ \"id\": 675353, \"results\": [ { \"iso_639_1\": \"zh\", \"iso_3166_1\": \"TW\", \"name\": \"【音速小子2】首支預告 - 2022年 全台戲院見\", \"key\": \"o_unED06-lg\", \"site\": \"YouTube\", \"size\": 1080, \"type\": \"Trailer\", \"official\": false, \"published_at\": \"2021-12-10T01:51:44.000Z\", \"id\": \"620cd7505cea180043ddbfdb\" } ] }\n -->\n      <iframe\n        class=\"youtube-iframe\"\n        :src=\"'https://www.youtube.com/embed/' + trailer\"\n        title=\"YouTube video player\"\n        frameborder=\"0\"\n        allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n        allowfullscreen\n      ></iframe>\n    </div>\n  </div>\n  <div class=\"nmtitle-section\" v-if=\"similarMovies && similarMovies.length\">\n    <div class=\"section-header\">\n      <h2 class=\"section-header-text\">類似影片</h2>\n    </div>\n    <div class=\"section-body\">\n      <div class=\"similarMovies\">\n        <div :key=\"movie.id\" v-for=\"movie in similarMovies\">\n          <div v-if=\"movie.backdrop_path\" class=\"similarMovies-item\">\n            <a @click=\"goToMovie(movie.id)\">\n              <img\n                :src=\"\n                  'https://image.tmdb.org/t/p/w250_and_h141_face' +\n                  movie.backdrop_path\n                \"\n                alt=\"\"\n              />\n              <span class=\"title\">{{ movie.title }}</span>\n            </a>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.movieSection {\n  margin: 0px 3%;\n  padding: 0px 5vw 25px;\n  position: relative;\n  display: flex;\n  overflow: hidden;\n\n  .info {\n    width: 35%;\n    min-width: 500px;\n    max-width: 800px;\n    padding: 16px 32px 64px 0;\n    z-index: 2;\n    position: relative;\n\n    color: var(--color-text);\n\n    h1 {\n      color: inherit;\n      width: 100%;\n      margin-top: 45%;\n      font-size: 58px;\n    }\n    .info-metadata {\n      color: #a3a3a3;\n      .info-spacer {\n        margin: 0 4px;\n      }\n    }\n    .info-desc {\n      padding-top: 16px;\n      font-size: 16px;\n      line-height: 22px;\n      font-weight: 400;\n      color: var(--color-text);\n      max-width: 100%;\n    }\n  }\n\n  .img-box {\n    position: unset;\n    flex: 1 1 auto;\n    z-index: 1;\n    height: 0;\n    padding-bottom: 50%;\n\n    .img-bg {\n      position: absolute;\n      right: -6%;\n      width: 100%;\n      height: 100%;\n      display: block;\n      background-size: cover;\n      background-repeat: no-repeat;\n      background-position: 50% 50%;\n    }\n  }\n}\n\n.dark .movieSection::after {\n  content: \"\";\n  position: absolute;\n  z-index: 1;\n  display: block;\n  width: 50%;\n  height: 100%;\n  background: linear-gradient(\n    to right,\n    var(--color-background) 10%,\n    rgba(23, 23, 23, 0.98) 20%,\n    rgba(23, 23, 23, 0.97) 25%,\n    rgba(23, 23, 23, 0.95) 35%,\n    rgba(23, 23, 23, 0.94) 40%,\n    rgba(23, 23, 23, 0.92) 45%,\n    rgba(23, 23, 23, 0.9) 50%,\n    rgba(23, 23, 23, 0.87) 55%,\n    rgba(23, 23, 23, 0.82) 60%,\n    rgba(23, 23, 23, 0.75) 65%,\n    rgba(23, 23, 23, 0.63) 70%,\n    rgba(23, 23, 23, 0.45) 75%,\n    rgba(23, 23, 23, 0.27) 80%,\n    rgba(23, 23, 23, 0.15) 85%,\n    rgba(23, 23, 23, 0.08) 90%,\n    rgba(23, 23, 23, 0.03) 95%,\n    rgba(23, 23, 23, 0) 100%\n  );\n  top: 0;\n  left: 0;\n}\n@media screen and (max-width: 480px) {\n  .dark .movieSection::after {\n    width: 100%;\n    background: rgb(0 0 0 / 40%);\n  }\n}\n\n.light .movieSection::after {\n  content: \"\";\n  position: absolute;\n  z-index: 1;\n  display: block;\n  width: 50%;\n  height: 100%;\n  background: linear-gradient(\n    to right,\n    var(--color-background) 10%,\n    rgba(232, 232, 232, 0.98) 20%,\n    rgba(232, 232, 232, 0.97) 25%,\n    rgba(232, 232, 232, 0.95) 35%,\n    rgba(232, 232, 232, 0.94) 40%,\n    rgba(232, 232, 232, 0.92) 45%,\n    rgba(232, 232, 232, 0.9) 50%,\n    rgba(232, 232, 232, 0.87) 55%,\n    rgba(232, 232, 232, 0.82) 60%,\n    rgba(232, 232, 232, 0.75) 65%,\n    rgba(232, 232, 232, 0.63) 70%,\n    rgba(232, 232, 232, 0.45) 75%,\n    rgba(232, 232, 232, 0.27) 80%,\n    rgba(232, 232, 232, 0.15) 85%,\n    rgba(232, 232, 232, 0.08) 90%,\n    rgba(232, 232, 232, 0.03) 95%,\n    rgba(232, 232, 232, 0) 100%\n  );\n  top: 0;\n  left: 0;\n}\n@media screen and (max-width: 480px) {\n  .light .movieSection::after {\n    width: 100%;\n    background: rgb(255 255 255 / 50%);\n  }\n}\n\n.nmtitle-section {\n  margin: 0px 3%;\n  padding: 25px 5vw;\n  position: relative;\n\n  .section-header {\n    display: flex;\n    align-items: center;\n\n    .section-header-text {\n      font-size: 30px;\n      line-height: 34px;\n      font-weight: 400;\n      color: var(--color-text);\n    }\n    .section-subheader-text {\n      border-left: 1px solid #a3a3a3;\n      margin-left: 9px;\n      padding-left: 15px;\n      color: #a3a3a3;\n      font-size: 20px;\n      white-space: nowrap;\n    }\n  }\n}\n\n.similarMovies {\n  display: grid;\n  grid-template-columns: 25% 25% 25% 25%;\n  margin: -6px;\n\n  @media screen and (max-width: 1439px) {\n    grid-template-columns: 33.333% 33.333% 33.333%;\n  }\n  @media screen and (max-width: 1024px) {\n    grid-template-columns: 50% 50%;\n  }\n  .similarMovies-item {\n    max-width: 100%;\n    margin: 6px;\n\n    img {\n      width: 100%;\n    }\n\n    .title {\n      display: block;\n      color: var(--color-text);\n    }\n  }\n}\n\n@media screen and (max-width: 1760px) {\n  .movieSection,\n  .nmtitle-section {\n    margin: 0px;\n  }\n}\n\n@media screen and (max-width: 640px) {\n  .movieSection {\n    .info {\n      width: 100%;\n      max-width: 100%;\n      min-width: unset;\n\n      h1 {\n        font-size: 42px;\n        margin-top: 15%;\n      }\n    }\n    .img-box {\n      .img-bg {\n        right: 0%;\n      }\n    }\n  }\n}\n\n@media screen and (max-width: 480px) {\n  .movieSection {\n    .info {\n      h1 {\n        font-size: 32px;\n        margin-top: 15%;\n      }\n      .info-desc {\n        font-size: 14px;\n      }\n    }\n    &::after {\n      width: 100%;\n      background: rgb(0 0 0 / 60%);\n    }\n  }\n}\n\n.youtube-iframe {\n  width: 620px;\n  height: 350px;\n\n  @media screen and (max-width: 768px) {\n    width: 100%;\n    height: 280px;\n  }\n  @media screen and (max-width: 480px) {\n    height: 200px;\n  }\n}\n</style>\n"],"names":[],"mappings":"0kCAYA,KAAM,GAAS,EAAS,EAClB,EAAQ,EAAQ,EAChB,EAAK,EAAM,OAAO,GAClB,EAAY,IAAM,KAAK,SAAS,SAAS,EACzC,EAAY,EAAI,CAAA,CAAE,EAClB,EAAc,EAAI,CAAA,CAAE,EACpB,EAAgB,EAAI,CAAA,CAAE,EAE5B,AAAI,EACF,AAAI,EACF,GAAoB,CAAE,EAAE,KAAK,AAAC,GAAQ,CACpC,QAAQ,IAAI,MAAO,CAAG,EACtB,EAAU,MAAQ,EAAI,KACtB,EAAiB,EAAI,KAAK,MAAM,CACtC,CAAK,EAED,EAAqB,CAAE,EAAE,KAAK,AAAC,GAAQ,CACrC,QAAQ,IAAI,UAAW,EAAI,IAAI,EAC/B,EAAY,MAAQ,EAAI,IAC9B,CAAK,GAED,GAAkB,CAAE,EAAE,KAAK,AAAC,GAAQ,CAClC,QAAQ,IAAI,MAAO,CAAG,EACtB,EAAU,MAAQ,EAAI,KACtB,EAAiB,EAAI,KAAK,MAAM,CACtC,CAAK,EAED,EAAqB,CAAE,EAAE,KAAK,AAAC,GAAQ,CACrC,QAAQ,IAAI,UAAW,EAAI,IAAI,EAC/B,EAAY,MAAQ,EAAI,IAC9B,CAAK,GAGH,MAAM,OAAO,EAGf,KAAM,GAAU,EAAS,IAAM,OAC7B,GAAI,GAAQ,KAAY,MAAM,UAAlB,QAA2B,OACnC,EAAY,MAAM,QAAQ,GAC1B,KACA,EAAa,GACjB,MAAI,IACE,EAAM,KAAK,YAAa,IAAK,WAAa,EAAM,KAClD,GAAa,IAIV,EAAa,EAAM,IAAM,IAClC,CAAC,EAEK,EAAmB,AAAC,GAAS,CACjC,GAAI,EAAM,CACR,GAAI,GACJ,MAAI,GAAK,OAAO,SAAW,SACzB,GAAa,UAEX,EAAK,OAAO,SAAW,MACzB,GAAa,KAER,EAAK,MAAM,CAAU,EAAE,GAAK,CACpC,CACD,MAAO,EACT,EAGM,EAAiB,SAAU,EAAM,CACrC,GAAI,EAAM,MAAO,GAAK,MAAM,GAAG,EAAE,EACnC,EAEM,EAAa,AAAC,GAAS,CAC3B,GAAI,EAAM,CACR,GAAI,GAAS,GAEb,KAAM,GAAK,KAAK,MAAM,EAAO,EAAM,EAC7B,EAAK,KAAK,MAAM,EAAO,EAAM,EACnC,MAAI,IAAI,IAAU,GAAG,mBACjB,GAAI,IAAU,GAAG,kBACd,CACR,CACH,EAGM,EAAgB,AAAC,GAAW,CAChC,GAAI,GAAU,MAAM,QAAQ,CAAM,GAAK,EAAO,OAC5C,MAAO,GAAO,GAAG,IAErB,EAEM,EAAY,AAAC,GACV,UAAK,WAGR,EAAmB,AAAC,GAAW,CACnC,GAAI,GAAU,EAAO,OAAQ,CAC3B,GAAI,GACJ,AAAI,EACF,EAAO,EAAO,GAAG,IAEjB,EAAO,EAAO,IAAI,AAAC,GAAM,EAAE,EAAE,EAAE,OAGjC,EAAmB,EAAG,CAAI,EAAE,KAAK,AAAC,GAAW,CAC3C,GAAI,GAAO,EAAO,KAAK,QACvB,EAAc,MAAQ,EAAK,OAAO,AAAC,GAAM,EAAE,KAAO,EAAU,MAAM,EAAE,CAC1E,CAAK,CACF,CACH,EAEA,WAAmB,EAAI,CACrB,EAAO,KAAK,CAAE,KAAM,UAAU,GAAI,CAAE,CACtC"}